 <!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>スポンサー情報まとめ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <button id="menu-btn" aria-label="メニューを開く">☰</button>
  <h1>スポンサー情報まとめ</h1>
</header>

<nav id="menu" aria-hidden="true">
  <div id="menu-content">読み込み中…</div>
</nav>

<main id="content">読み込み中…</main>

<script src="parser.js"></script>
<script>
  const btn = document.getElementById('menu-btn');
  const menu = document.getElementById('menu');

  // ☰ メニュー開閉
  btn.addEventListener('click', (e) => {
    e.stopPropagation();
    menu.classList.toggle('open');
    menu.setAttribute(
      'aria-hidden',
      !menu.classList.contains('open')
    );
  });

  // メニュー内リンククリックで閉じる
  menu.addEventListener('click', (e) => {
    if (e.target.tagName === 'A') {
      menu.classList.remove('open');
      menu.setAttribute('aria-hidden', 'true');
    }
  });

  // メニュー外クリックで閉じる（スマホ向け）
  document.addEventListener('click', (e) => {
    if (
      menu.classList.contains('open') &&
      !menu.contains(e.target) &&
      e.target !== btn
    ) {
      menu.classList.remove('open');
      menu.setAttribute('aria-hidden', 'true');
    }
  });

  // メニュー読み込み
  loadMenu();
  async function loadMenu() {
    const res = await fetch('pages/menu.txt');
    const text = await res.text();
    document.getElementById('menu-content').innerHTML = parse(text);
    markMissingLinks();
  }

  // ページ読み込み
  const params = new URLSearchParams(location.search);
  const page = params.get('page') || 'top';
  loadPage(`pages/${page}.txt`);
</script>

</body>
</html>